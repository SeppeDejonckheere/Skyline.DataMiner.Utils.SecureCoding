namespace SecureCoding.SecureSerialization.Tests
{
    using Microsoft.VisualStudio.TestTools.UnitTesting;

    [TestClass()]
    public class KnownExploitableTypesTests
    {
        [DataTestMethod]
        [DataRow("System.Data.DataSet", true)]
        [DataRow("System.Security.Principal.WindowsIdentity", true)]
        [DataRow("System.Management.Automation.PSObject", true)]
        [DataRow("System.String", false)]
        [DataRow("System.Int32", false)]
        [DataRow("System.Collections.Generic.List`1", false)]
        [DataRow("system.data.dataset", true)]
        [DataRow("SYSTEM.SECURITY.PRINCIPAL.WINDOWSIDENTITY", true)]
        [DataRow("system.management.automation.psobject", true)]
        [DataRow("system.string", false)]
        [DataRow("SYSTEM.INT32", false)]
        [DataRow("Token", false)]
        public void IsKnownExploitableTypeTest(string typeFullName, bool expected)
        {
            bool actual = KnownExploitableTypes.IsKnownExploitableType(typeFullName);

            Assert.AreEqual(expected, actual);
        }
    }
}